from numpy import *
import os

"""
parameters = [[   # n = 2, w= 1, 0.5, 0.1, 0.05,0.01
        [.992067,.400016,0.001],[.952981,.354743,0.001],[.952833,.354292,0.005],[.913976,.235196,0.01],[.911692,.203919,0.01]
    ],[ # n = 6
        [1.03741,.472513,0.001],[.931202,.395044,0.005],[0.831104,.211443,0.01],[.849742,.155566,0.05],[.842683,.10789,.1]        
    ],[ # n = 12
        [1.10364,.468861,0.001],[.936306,.414534,0.005],[.84105,.218143,0.01],[.842746,.153921,0.05],[.835467,.0923274,0.1]     
    ],[ # n = 20 (a,b,dt)
        [1.06019,.474467,0.005],[.944121,.419367,0.01],[.856981,.200372,0.05],[.842341,.153017,0.1],[.835301,.0922157,0.5]        
    ]]
"""
"""
parameters = [[   # n = 2, w= 1, 0.5, 0.1, 0.05,0.01
        [.992067,.400016,0.001],[.952981,.354743,0.0025],[.952833,.354292,0.005],[.913976,.235196,0.075],[.911692,.203919,0.01]
    ],[ # n = 6
        [1.03741,.472513,0.001],[.931202,.395044,0.0025],[0.831104,.211443,0.05],[.849742,.155566,0.075],[.842683,.10789,.01]        
    ],[ # n = 12
        [1.10364,.468861,0.001],[.936306,.414534,0.0025],[.84105,.218143,0.05],[.842746,.153921,0.075],[.835467,.0923274,0.01]     
    ],[ # n = 20 (a,b,dt)
        [1.06019,.474467,0.001],[.944121,.419367,0.0025],[.856981,.200372,0.05],[.842341,.153017,0.075],[.835301,.0922157,0.01]        
    ]]
"""

from numpy import *
import os

for a in [0.5, 1.0, 1.5, 2.0]:
    outfile = open("job%f.sh" % a, 'w')
    outfile.write("#!/bin/bash\n")
    outfile.write("#SBATCH --partition=normal \n")
    outfile.write("#SBATCH --nodes=26 \n")
    outfile.write("#SBATCH --ntasks-per-node=8 \n")
    outfile.write("#SBATCH --time=2:00:00 \n")
    outfile.write("#SBATCH --job-name=batmobile \n")
    outfile.write("mpirun ./batman 100 %f \n" % a)
    outfile.close()
    print "sbatch job%f.sh" % a
    os.popen("sbatch job%f.sh" % a)


parameters = [[   # n = 2, w= 1, 0.5, 0.1, 0.05,0.01
        [.992067,.400016,0.001],[.952981,.354743,0.0025],[.952833,.354292,0.005],[.913976,.235196,0.075],[.911692,.203919,0.01]
    ],[ # n = 6
        [1.03741,.472513,0.001],[.931202,.395044,0.0025],[0.831104,.211443,0.05],[.849742,.155566,0.075],[.842683,.10789,.01]        
    ],[ # n = 12
        [1.10364,.468861,0.001],[.936306,.414534,0.0025],[.84105,.218143,0.05],[.842746,.153921,0.075],[.835467,.0923274,0.5]     
    ],[ # n = 20 (a,b,dt)
        [1.06019,.474467,0.001],[.944121,.419367,0.0025],[.856981,.200372,0.05],[.842341,.153017,0.075],[.835301,.0922157,0.5]        
    ]]


path = "/home/marius/Dokumenter/fys4411/postmann.pat/code/build-mons-Desktop_Qt_5_7_0_GCC_64bit-Release/mons"
threads = 4
#print param
i = 0
for n, ns in zip([2,6,12,20], parameters):
    for w, param in zip([1,0.5,0.1,0.05,0.01], ns):
        i += 1

        command = "/usr/bin/mpirun -n %g %s %g %g %g %g %g" % (threads, path, n, param[0], param[1], w, param[2])
        #print command
        #if (i == 15 or i == 20):
        print os.system(command)
